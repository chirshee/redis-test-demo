# redis-test-demo
redis demo for the  "缓存击穿"

### Redis缓存穿透实战

### 1. 什么是缓存穿透

**使用redis查询数据的正常流程：**

* 前端访问数据， 首先会在缓存redis中查询，如果查询到数据， 则将数据返回给用户，流程结束
* 如果在数据库中没有查询到数据，则前往数据库中查询，如果此时能查到数据， 则将数据返回给用户，同时将数据塞到缓存中, 流程结束
* 如果在数据库中也没有查到数据，则返回null，流程结束

**造成缓存穿透的原因**： 

> 如果前端频繁的发起访问请求，恶意的提供不存在的key, 则数数据库中查询到的数据永远为Null,**由于null数据是不会存入缓存中的**， 因此每次访问请求时将查询数据库，如果此时有恶意攻击，发起“洪流“式的查询，则很有可能对的数据库造成极大的压力，甚至压垮数据库
>
> **缓存穿透**： 永远越过了缓存而直接永远地访问数据库

**缓存穿透的解决方案：**

* 当从数据库中的查询不到数据的时候，则将null存入缓存， 并给key设置一个TTL，设置过期时间，这样可以降低数据查询的频率

### 2. 缓存雪崩和缓存击穿

**（1）缓存雪崩**：指的是在某个时间点，缓存中的Key集体发生过期失效致使大量查询数据库的请求都落在了DB（数据库）上，导致数据库负载过高，压力暴增，甚至有可能“压垮”数据库。这种问题产生的原因其实主要是因为大量的Key在某个时间点或者某个时间段过期失效导致的。所以为了更好地避免这种问题的发生，一般的做法是为这些Key设置不同的、随机的TTL（过期失效时间），从而错开缓存中 Key的失效时间点，可以在某种程度上减少数据库的查询压力。
**（2）缓存击穿**：指缓存中某个频繁被访问的Key（可以称为“热点Key”），在不停地扛着前端的高并发请求，当这个Key突然在某个瞬间过期失效时，持续的高并发访问请求就“穿破”缓存，直接请求数据库，导致数据库压力在某一瞬间暴增。这种现象就像是“在一张薄膜上凿出了一个洞”。这个问题产生的原因主要是热点的Key过期失效了，而在实际情况中，既然这个Key可以被当作“热点”频繁访问，那么就应该设置这个Key永不过期，这样前端的高并发请求将几乎永远不会落在数据库上。


